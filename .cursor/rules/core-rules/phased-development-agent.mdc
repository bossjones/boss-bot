---
description: "This rule governs the phased development approach. It should be applied whenever: (1) Creating new features or modules, (2) Modifying existing code, (3) Reviewing implementation details, or (4) Planning development tasks. This ensures we stick to the planned development phases and don't implement features prematurely."
globs: src/**/*.py, tests/**/*.py
alwaysApply: false
---

# Phased Development Standards

## Critical Rules

- ALWAYS check the architecture document's phase plan before implementing any feature
- NEVER implement features from a future phase unless explicitly requested
- Phase 1 (MVP) focuses ONLY on:
  * Basic project structure and environment
  * Core download functionality
  * Basic queue management
  * Essential error handling
  * Basic metrics/monitoring
  * Basic storage with quotas
- Phase 2 features are OFF LIMITS unless requested:
  * Progress tracking
  * File management and cleanup
  * Enhanced error handling
  * Monitoring dashboards
  * User management
  * Bot admin features
- Phase 3 features are OFF LIMITS unless requested:
  * API key rotation
  * Rate limiting
  * Enhanced storage security
  * Granular permissions
  * Audit logging
  * Security monitoring
- Phase 4 features are OFF LIMITS unless requested:
  * Vector store
  * Document processing
  * RAG functionality
  * Enhanced commands
- When in doubt about which phase a feature belongs to, ASK the user
- Document any deviations from the phased approach in comments

## Examples

<example>
# Good - Sticking to MVP Phase
```python
class QuotaManager:
    """Storage quota management."""

    def __init__(self, storage_root: Path, config: QuotaConfig | None = None):
        self.storage_root = storage_root
        self.config = config or QuotaConfig()

    def check_quota(self, file_size: int) -> bool:
        """Basic quota check for MVP."""
        return self.get_total_size() + file_size <= self.config.max_size
```

# Good - Documenting Phase Deviation
```python
# NOTE: Implementing this Phase 2 feature early per user request in PR #123
def track_download_progress(self, download_id: str, progress: float):
    """Track download progress - Phase 2 feature."""
    self.progress_tracker.update(download_id, progress)
```
</example>

<example type="invalid">
# Bad - Implementing Future Phase Features Without Request
```python
class QuotaManager:
    """Storage quota management."""

    def __init__(self, storage_root: Path):
        self.storage_root = storage_root
        # BAD: Implementing Phase 2 cleanup without request
        self.cleanup_scheduler = CleanupScheduler()
        self.retention_policy = RetentionPolicy()

    def cleanup_old_files(self):
        # BAD: This is a Phase 2 feature
        for file in self.storage_root.glob("**/*"):
            if self.retention_policy.should_delete(file):
                file.unlink()
```

# Bad - Mixing Phases Without Documentation
```python
class StorageManager:
    def __init__(self):
        self.quota = QuotaManager()  # MVP feature
        self.audit_logger = AuditLogger()  # BAD: Phase 3 feature
        self.vector_store = VectorStore()  # BAD: Phase 4 feature
```
</example>
